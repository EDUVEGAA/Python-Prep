# -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------
# SCRPITGISAGUAPRIMARIA.py
# Created on: 2022-02-10 20:29:55.00000
#   (generated by ArcGIS/ModelBuilder)
# Usage: SCRPITGISAGUAPRIMARIA <wMain> <AguaPotable> 
# Description: 
# ---------------------------------------------------------------------------

# Set the necessary product code
# import arcinfo


# Import arcpy module
import arcpy

# Script arguments
wMain = arcpy.GetParameterAsText(0)
if wMain == '#' or not wMain:
    wMain = "D:\\GRD_SEDAPAL\\lurigancho\\AguaPotable.mdb\\WaterDistribution\\wMain" # provide a default value if unspecified

AguaPotable = arcpy.GetParameterAsText(1)
if AguaPotable == '#' or not AguaPotable:
    AguaPotable = "D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\AguaPotable" # provide a default value if unspecified

# Local variables:
wMainPrimaGRD = wMain
wMainPrimaGRD__2_ = wMainPrimaGRD
wMainPrimaGRD__3_ = wMainPrimaGRD__2_
wMainPrimaGRD__4_ = wMainPrimaGRD__3_
wMainPrimaGRD__6_ = wMainPrimaGRD__4_
wMainPrimaGRD__5_ = wMainPrimaGRD__6_
wMainPrimaGRD__53_ = wMainPrimaGRD__5_
wMGRD_Cen = "D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Borradores\\wMGRD_Cen"
Mapa_Ccss_Ggss = "D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Mapas_Peligros\\Mapa_Ccss_Ggss"
wMGRD_CS = "D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Borradores\\wMGRD_CS"
wMainPrimaGRD__7_ = wMainPrimaGRD__53_
Mapa_Peligro_Sismico__2_ = "D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Mapas_Peligros\\Mapa_Peligro_Sismico"
wMGRD_sis = "D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Borradores\\wMGRD_sis"
wMainPrimaGRD__8_ = wMainPrimaGRD__7_
wMainPrimaGRD__9_ = wMainPrimaGRD__8_
MAPA_PELIGRO_DESLIZAMIENTOS = "D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Mapas_Peligros\\MAPA_PELIGRO_DESLIZAMIENTOS"
wMGRD_Desl = "D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Borradores\\wMGRD_Desl"
wMainPrimaGRD__11_ = wMainPrimaGRD__9_
wMainPrimaGRD__12_ = wMainPrimaGRD__11_
MAPA_PELIGRO_INUNDACIONES__2_ = "D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Mapas_Peligros\\MAPA_PELIGRO_INUNDACIONES"
wMGRD_inun = "D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Borradores\\wMGRD_inun"
wMGRD_inun__3_ = wMainPrimaGRD__12_
wMGRD_inun__4_ = wMGRD_inun__3_
Mapa_Multipeligro = "D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Mapas_Peligros\\Mapa_Multipeligro"
wMGRD_MT = "D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Borradores\\wMGRD_MT"
wMGRD_inun__5_ = wMGRD_inun__4_
wMainPrimaGRD__16_ = wMGRD_inun__5_
wMainPrimaGRD__17_ = wMainPrimaGRD__16_
wMainPrimaGRD__18_ = wMainPrimaGRD__17_
wMainPrimaGRD__19_ = wMainPrimaGRD__18_
wMainPrimaGRD__20_ = wMainPrimaGRD__19_
wMainPrimaGRD__21_ = wMainPrimaGRD__20_
wMainPrimaGRD__22_ = wMainPrimaGRD__21_
wMainPrimaGRD__23_ = wMainPrimaGRD__22_
wMainPrimaGRD__24_ = wMainPrimaGRD__23_
wMainPrimaGRD__25_ = wMainPrimaGRD__24_
wMainPrimaGRD__26_ = wMainPrimaGRD__25_
wMainPrimaGRD__27_ = wMainPrimaGRD__26_
wMainPrimaGRD__28_ = wMainPrimaGRD__27_
wMainPrimaGRD__29_ = wMainPrimaGRD__28_
wMainPrimaGRD__30_ = wMainPrimaGRD__29_
wMainPrimaGRD__10_ = wMainPrimaGRD__30_
wMainPrimaGRD__32_ = wMainPrimaGRD__10_
wMainPrimaGRD__33_ = wMainPrimaGRD__32_
wMainPrimaGRD__34_ = wMainPrimaGRD__33_
wMainPrimaGRD__35_ = wMainPrimaGRD__34_
wMainPrimaGRD__36_ = wMainPrimaGRD__35_
wMainPrimaGRD__37_ = wMainPrimaGRD__36_
wMainPrimaGRD__38_ = wMainPrimaGRD__37_
wMainPrimaGRD__39_ = wMainPrimaGRD__38_
wMainPrimaGRD__40_ = wMainPrimaGRD__39_
wMainPrimaGRD__41_ = wMainPrimaGRD__40_
wMainPrimaGRD__42_ = wMainPrimaGRD__41_
wMainPrimaGRD__43_ = wMainPrimaGRD__42_
wMainPrimaGRD__44_ = wMainPrimaGRD__43_
wMainPrimaGRD__45_ = wMainPrimaGRD__44_
wMainPrimaGRD__46_ = wMainPrimaGRD__45_
wMainPrimaGRD__47_ = wMainPrimaGRD__46_
wMainPrimaGRD__48_ = wMainPrimaGRD__47_
wMainPrimaGRD__49_ = wMainPrimaGRD__48_
wMainPrimaGRD__50_ = wMainPrimaGRD__49_
wMainPrimaGRD__51_ = wMainPrimaGRD__50_
wMainPrimaGRD__52_ = wMainPrimaGRD__51_

# Process: Feature Class to Feature Class
arcpy.FeatureClassToFeatureClass_conversion(wMain, AguaPotable, "wMainPrimaGRD", "[PRIMARYNETWORK] = 1", "FACILITYID \"Identificador\" true false false 30 Text 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\AguaPotable.mdb\\WaterDistribution\\wMain,FACILITYID,-1,-1;MATERIAL \"Material\" true false false 50 Text 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\AguaPotable.mdb\\WaterDistribution\\wMain,MATERIAL,-1,-1;PRIMARYNETWORK \"Red Primaria\" true false false 2 Short 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\AguaPotable.mdb\\WaterDistribution\\wMain,PRIMARYNETWORK,-1,-1;INSTALLDATE \"Fecha de instalación\" true true false 8 Date 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\AguaPotable.mdb\\WaterDistribution\\wMain,INSTALLDATE,-1,-1", "")

# Process: Add Field
arcpy.AddField_management(wMainPrimaGRD, "ORDEN", "LONG", "10", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (10)
arcpy.AddField_management(wMainPrimaGRD__2_, "GRADOPE_SISMICO", "TEXT", "5", "", "20", "Grado_Peligro_sismico", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (16)
arcpy.AddField_management(wMainPrimaGRD__3_, "GRADOPE_DESLIZA", "TEXT", "5", "", "20", "Grado_Peligro_Deslizamientos", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (17)
arcpy.AddField_management(wMainPrimaGRD__4_, "GRADOPE_INUNDA", "TEXT", "5", "", "30", "Grado_Peligro_Inundaciones", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field
arcpy.CalculateField_management(wMainPrimaGRD__6_, "ORDEN", "autoIncrement()", "PYTHON_9.3", "rec=0 \\ndef autoIncrement(): \\n global rec \\n pStart = 1 #adjust start value, if req'd  \\n pInterval = 1 #adjust interval value, if req'd \\n if (rec == 0):  \\n  rec = pStart  \\n else:  \\n  rec = rec + pInterval  \\n return rec")

# Process: Feature To Point (2)
arcpy.FeatureToPoint_management(wMainPrimaGRD__5_, wMGRD_Cen, "CENTROID")

# Process: Spatial Join (6)
arcpy.SpatialJoin_analysis(wMGRD_Cen, Mapa_Ccss_Ggss, wMGRD_CS, "JOIN_ONE_TO_MANY", "KEEP_ALL", "FACILITYID \"Identificador\" true false false 30 Text 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Temporales\\wMGRD_Cent,FACILITYID,-1,-1;MATERIAL \"Material\" true false false 50 Text 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Temporales\\wMGRD_Cent,MATERIAL,-1,-1;PRIMARYNETWORK \"Red Primaria\" true false false 2 Short 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Temporales\\wMGRD_Cent,PRIMARYNETWORK,-1,-1;INSTALLDATE \"Fecha de instalación\" true true false 8 Date 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Temporales\\wMGRD_Cent,INSTALLDATE,-1,-1;ORDEN \"ORDEN\" true true false 0 Long 10 20 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Temporales\\wMGRD_Cent,ORDEN,-1,-1;GRADOPE_SISMICO \"Grado_Peligro_sismico\" true true false 20 Text 5 10 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Temporales\\wMGRD_Cent,GRADOPE_SISMICO,-1,-1;GRADOPE_DESLIZA \"Grado_Peligro_Deslizamientos\" true true false 20 Text 5 10 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Temporales\\wMGRD_Cent,GRADOPE_DESLIZA,-1,-1;GRADOPE_INUNDA \"Grado_Peligro_Inundaciones\" true true false 30 Text 5 10 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Temporales\\wMGRD_Cent,GRADOPE_INUNDA,-1,-1;ORIG_FID \"ORIG_FID\" true true false 0 Long 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Temporales\\wMGRD_Cent,ORIG_FID,-1,-1;CCSS_T \"CCSS_T\" true true false 50 Text 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Mapas_Peligros\\Mapa_Ccss_Ggss,CCSS_T,-1,-1;GGSS \"GGSS\" true true false 50 Text 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Mapas_Peligros\\Mapa_Ccss_Ggss,GGSS,-1,-1;Shape_Length \"Shape_Length\" false true true 8 Double 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Mapas_Peligros\\Mapa_Ccss_Ggss,Shape_Length,-1,-1;Shape_Area \"Shape_Area\" false true true 8 Double 0 0 ,First,#,D:\\GRD_SEDAPAL\\lurigancho\\GRD_SistemaRedes.mdb\\Mapas_Peligros\\Mapa_Ccss_Ggss,Shape_Area,-1,-1", "INTERSECT", "", "")

# Process: Join Field (5)
arcpy.JoinField_management(wMainPrimaGRD__5_, "ORDEN", wMGRD_CS, "ORDEN", "CCSS_T;GGSS")

# Process: Spatial Join (2)
arcpy.SpatialJoin_analysis(wMGRD_Cen, Mapa_Peligro_Sismico__2_, wMGRD_sis, "JOIN_ONE_TO_MANY", "KEEP_ALL", "", "INTERSECT", "", "")

# Process: Join Field
arcpy.JoinField_management(wMainPrimaGRD__53_, "ORDEN", wMGRD_sis, "ORDEN", "PSS")

# Process: Calculate Field (10)
arcpy.CalculateField_management(wMainPrimaGRD__7_, "GRADOPE_SISMICO", "PELIGRO_SISMO", "VB", "Dim PELIGRO_SISMO \\n\\nIf [PSS]=0 then\\nPELIGRO_SISMO = \"Muy Alto\"\\n\\nelseif [PSS] >0 AND [PSS] <=1 then\\nPELIGRO_SISMO = \"Muy Alto\"\\n\\nelseif [PSS] >1 AND [PSS] <=2 then\\nPELIGRO_SISMO = \"Alto\"\\n\\nelseif [PSS] >2 AND [PSS] <=3 then\\nPELIGRO_SISMO = \"Medio\"\\n\\nelseif [PSS] >3 AND [PSS] <=4 then\\nPELIGRO_SISMO = \"Bajo\"\\n\\nelseif [PSS] >4 AND [PSS] <=5 then\\nPELIGRO_SISMO = \"Muy Bajo\"\\n\\nelse\\nPELIGRO_SISMO = \"Sin Dato\"\\n\\nend if")

# Process: Spatial Join (3)
arcpy.SpatialJoin_analysis(wMGRD_Cen, MAPA_PELIGRO_DESLIZAMIENTOS, wMGRD_Desl, "JOIN_ONE_TO_ONE", "KEEP_ALL", "", "INTERSECT", "", "")

# Process: Join Field (2)
arcpy.JoinField_management(wMainPrimaGRD__8_, "ORDEN", wMGRD_Desl, "ORDEN", "PTD")

# Process: Calculate Field (16)
arcpy.CalculateField_management(wMainPrimaGRD__9_, "GRADOPE_DESLIZA", "GRADOPE_DESLIZA", "VB", "Dim GRADOPE_DESLIZA\\n\\nIf [PTD]=0 then\\nGRADOPE_DESLIZA= \"Muy Alto\"\\n\\nelseif [PTD] >0 AND [PTD] <=1 then\\nGRADOPE_DESLIZA= \"Muy Alto\"\\n\\nelseif [PTD] >1 AND [PTD] <=2 then\\nGRADOPE_DESLIZA= \"Alto\"\\n\\nelseif [PTD] >2 AND [PTD] <=3 then\\nGRADOPE_DESLIZA= \"Medio\"\\n\\nelseif [PTD] >3 AND [PTD] <=4 then\\nGRADOPE_DESLIZA= \"Bajo\"\\n\\nelseif [PTD] >4 AND [PTD] <=5 then\\nGRADOPE_DESLIZA= \"Muy Bajo\"\\n\\nelse\\nGRADOPE_DESLIZA= \"Sin Dato\"\\n\\nend if")

# Process: Spatial Join (4)
arcpy.SpatialJoin_analysis(wMGRD_Cen, MAPA_PELIGRO_INUNDACIONES__2_, wMGRD_inun, "JOIN_ONE_TO_ONE", "KEEP_ALL", "", "INTERSECT", "", "")

# Process: Join Field (3)
arcpy.JoinField_management(wMainPrimaGRD__11_, "ORDEN", wMGRD_inun, "ORDEN", "PIHT;TIPO_INUNDACION")

# Process: Calculate Field (17)
arcpy.CalculateField_management(wMainPrimaGRD__12_, "GRADOPE_INUNDA", "PELIGRO_INUNDACION", "VB", "Dim PELIGRO_INUNDACION\\n\\nIf [PIHT]=0 then\\nPELIGRO_INUNDACION= \"Muy Alto, No Mitigable\"\\n\\nelseif [PIHT] >0 AND [PIHT] <=1 then\\nPELIGRO_INUNDACION= \"Muy Alto\"\\n\\nelseif [PIHT] >1 AND [PIHT] <=2 then\\nPELIGRO_INUNDACION= \"Alto\"\\n\\nelseif [PIHT] >2 AND [PIHT] <=3 then\\nPELIGRO_INUNDACION= \"Medio\"\\n\\nelseif [PIHT] >3 AND [PIHT] <=4 then\\nPELIGRO_INUNDACION= \"Bajo\"\\n\\nelseif [PIHT] >4 AND [PIHT] <=5 then\\nPELIGRO_INUNDACION= \"Muy Bajo\"\\n\\nelse\\nPELIGRO_INUNDACION= \"Sin Dato\"\\n\\nend if")

# Process: Spatial Join (5)
arcpy.SpatialJoin_analysis(wMGRD_Cen, Mapa_Multipeligro, wMGRD_MT, "JOIN_ONE_TO_ONE", "KEEP_ALL", "", "INTERSECT", "", "")

# Process: Join Field (4)
arcpy.JoinField_management(wMGRD_inun__3_, "ORDEN", wMGRD_MT, "ORDEN", "MTP")

# Process: Add Field (18)
arcpy.AddField_management(wMGRD_inun__4_, "PELIGRO_MTP", "LONG", "5", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field (18)
arcpy.CalculateField_management(wMGRD_inun__5_, "PELIGRO_MTP", "[MTP]", "VB", "")

# Process: Add Field (11)
arcpy.AddField_management(wMainPrimaGRD__16_, "Wp", "LONG", "5", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field (11)
arcpy.CalculateField_management(wMainPrimaGRD__17_, "Wp", "Wp", "VB", "Dim Wp\\nIf [PELIGRO_MTP] = 5 Then\\nWp= 1\\n\\nelseif [PELIGRO_MTP] = 4 Then\\nWp= 1\\n\\nelseif [PELIGRO_MTP] = 3 Then\\nWp= 1\\n\\nelseif [PELIGRO_MTP] = 2 Then\\nWp= 2\\n\\nelseif [PELIGRO_MTP] = 1 Then\\nWp= 3\\n\\nelse\\nWp= 0\\n\\nend if")

# Process: Add Field (3)
arcpy.AddField_management(wMainPrimaGRD__18_, "PUNT_MATERIAL", "DOUBLE", "", "", "", "PU_TipoTuberia", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (4)
arcpy.AddField_management(wMainPrimaGRD__19_, "PUNT_ANTIGU", "SHORT", "5", "", "", "PU_Antiguedad", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (5)
arcpy.AddField_management(wMainPrimaGRD__20_, "Antiguedad", "LONG", "5", "", "", "Antiguedad", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (6)
arcpy.AddField_management(wMainPrimaGRD__21_, "VULNERABI", "SHORT", "5", "", "", "Vulnerabilidad", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (7)
arcpy.AddField_management(wMainPrimaGRD__22_, "Wv", "DOUBLE", "10", "", "", "Peso_Ponderado_Vulnerabilidad", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (8)
arcpy.AddField_management(wMainPrimaGRD__23_, "RIESGO", "FLOAT", "5", "", "", "Riesgo", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (15)
arcpy.AddField_management(wMainPrimaGRD__24_, "AÑOS_PRY", "LONG", "", "", "", "Años_Proyectados", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (19)
arcpy.AddField_management(wMainPrimaGRD__25_, "ANTIGUEDAD_PRY", "LONG", "5", "", "", "Antiguedad_Proyectada", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (20)
arcpy.AddField_management(wMainPrimaGRD__26_, "PUNT_ANTIGPRY", "SHORT", "5", "", "", "Puntaje_Antiguedad_Proyectada", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (21)
arcpy.AddField_management(wMainPrimaGRD__27_, "VULNERA_PRY", "FLOAT", "5", "", "", "Vulnerabilidad_Proyectada", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (22)
arcpy.AddField_management(wMainPrimaGRD__28_, "WV_PRY", "DOUBLE", "10", "", "", "Wv_Proyectado", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (26)
arcpy.AddField_management(wMainPrimaGRD__29_, "RIESGO_PRY", "FLOAT", "5", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field (3)
arcpy.CalculateField_management(wMainPrimaGRD__30_, "PUNT_MATERIAL", "PUNT_MAT", "VB", "Dim PUNT_MAT \\n\\nif [MATERIAL] = \"PAD\"  or [MATERIAL] = \"PEAD\" or [MATERIAL] = \"PVCO\" or [MATERIAL] = \"PVC-O\" or [MATERIAL] = \"HD\" or [MATERIAL] = \"PD\" then\\nPUNT_MAT = \"5\"\\n\\nelseif [MATERIAL] = \"PE\" or [MATERIAL] = \"ACER\"  or [MATERIAL] = \"PR\" then\\nPUNT_MAT = \"4\"\\n\\nelseif [MATERIAL] = \"PVC\" or [MATERIAL] = \"FV\" or [MATERIAL] =  \"AR\" then\\nPUNT_MAT = \"3\"\\n\\nelseif [MATERIAL] = \"CR\"  or [MATERIAL] = \"AC\" or  [MATERIAL] = \"PRET\" or [MATERIAL] =  \"HF\"  or [MATERIAL] =  \"FOFO\"  or [MATERIAL] = \"FoFo\" or [MATERIAL] =  \"ALB\" then\\nPUNT_MAT = \"2\"\\n\\nelseif [MATERIAL] = \"FOGO\"  or [MATERIAL] = \"CP\" or [MATERIAL] = \"CSN\" or [MATERIAL] = \"HUME\" or [MATERIAL] = \"MAG\" or [MATERIAL] = \"FoGo\" then\\nPUNT_MAT = \"1\"\\n\\nelse\\nPUNT_MAT = \"0\" \\n\\nend if")

# Process: Calculate Field (4)
arcpy.CalculateField_management(wMainPrimaGRD__10_, "PUNT_ANTIGU", "PANTIG", "VB", "Dim PANTIG \\nDim ANTI\\n\\nANTI = DateDiff(\"yyyy\", [INSTALLDATE], Now()) \\n \\nif ANTI > 40 then\\nPANTIG = \"3\" \\n\\nelseif ANTI >= 15 and ANTI =< 40 then\\nPANTIG = \"2\"\\n\\nelseif ANTI < 15 then\\nPANTIG = \"1\"  \\n\\nelse \\nPANTIG = \"0\"\\n\\nend if")

# Process: Calculate Field (5)
arcpy.CalculateField_management(wMainPrimaGRD__32_, "Antiguedad", "ANTIG", "VB", "Dim ANTIG \\n\\nIf [INSTALLDATE] < Now() then\\nANTIG = DateDiff(\"yyyy\", [INSTALLDATE], Now()) \\n\\nelseif [INSTALLDATE] > Now() then\\nANTIG = DateDiff(\"yyyy\",  Now(), [INSTALLDATE])\\n\\nelse \\nANTIG = \"0\"\\n\\nend if")

# Process: Calculate Field (6)
arcpy.CalculateField_management(wMainPrimaGRD__33_, "VULNERABI", "VV", "VB", "Dim VV \\n\\nIf [PELIGRO_MTP] = 0 then\\nVV = 0\\n\\nelseif [PUNT_ANTIGU] = 0 then\\nVV = [PUNT_MATERIAL] \\n\\nelseif [PUNT_MATERIAL] = 0 then\\nVV = [PUNT_ANTIGU]\\n\\nelseif ( [PUNT_MATERIAL] - [PUNT_ANTIGU] ) >=1 then\\nVV = ( [PUNT_MATERIAL] - [PUNT_ANTIGU] )\\n\\nelseif ( [PUNT_MATERIAL] - [PUNT_ANTIGU] ) < 1 then\\nVV = 1\\n\\nelse\\nVV = 1\\n\\nend if")

# Process: Calculate Field (7)
arcpy.CalculateField_management(wMainPrimaGRD__34_, "Wv", "1", "VB", "")

# Process: Calculate Field (8)
arcpy.CalculateField_management(wMainPrimaGRD__35_, "RIESGO", "RIESGO", "VB", "Dim RIESGO \\n\\nIf [PELIGRO_MTP] = 0 then\\nRIESGO = 0\\n\\nelseif [PELIGRO_MTP] >=1 then\\nRIESGO = (( [PELIGRO_MTP] * [Wp] )+( [VULNERABI] *[Wv]))/( [Wp]+ [Wv] )\\n\\nelse\\nRIESGO = 6\\n\\nend if")

# Process: Calculate Field (23)
arcpy.CalculateField_management(wMainPrimaGRD__36_, "AÑOS_PRY", "30", "VB", "")

# Process: Calculate Field (14)
arcpy.CalculateField_management(wMainPrimaGRD__37_, "ANTIGUEDAD_PRY", "(DateDiff(\"yyyy\", [INSTALLDATE] , Now()) + [AÑOS_PRY])", "VB", "")

# Process: Calculate Field (19)
arcpy.CalculateField_management(wMainPrimaGRD__38_, "PUNT_ANTIGPRY", "PUNT_ANTIGU", "VB", "Dim PUNT_ANTIGU \\nDim Antiguedad\\n\\nAntiguedad = (DateDiff(\"yyyy\", [INSTALLDATE] , Now()) + [AÑOS_PRY])\\n \\nif Antiguedad > 40 then\\nPUNT_ANTIGU = \"3\" \\n\\nelseif Antiguedad >= 15 and Antiguedad =< 40 then\\nPUNT_ANTIGU = \"2\"\\n\\nelseif Antiguedad < 15 then\\nPUNT_ANTIGU = \"1\"  \\n\\nelse \\nPUNT_ANTIGU = \"0\"\\n\\nend if")

# Process: Calculate Field (20)
arcpy.CalculateField_management(wMainPrimaGRD__39_, "VULNERA_PRY", "VULNERABILIDAD", "VB", "Dim VULNERABILIDAD \\n\\nIf [PELIGRO_MTP] = 0 then\\nVULNERABILIDAD = 0\\n\\nelseif [PUNT_ANTIGPRY] = 0 then\\nVULNERABILIDAD = [PUNT_MATERIAL] \\n\\nelseif [PUNT_MATERIAL] = 0 then\\nVULNERABILIDAD = [PUNT_ANTIGPRY]\\n\\nelseif ( [PUNT_MATERIAL] - [PUNT_ANTIGPRY]) >=1 then\\nVULNERABILIDAD = ( [PUNT_MATERIAL] - [PUNT_ANTIGPRY])\\n\\nelseif ([PUNT_MATERIAL] - [PUNT_ANTIGPRY]) < 1 then\\nVULNERABILIDAD = 1\\n\\nelse\\nVULNERABILIDAD = 6\\n\\nend if")

# Process: Calculate Field (21)
arcpy.CalculateField_management(wMainPrimaGRD__40_, "WV_PRY", "1", "VB", "")

# Process: Calculate Field (22)
arcpy.CalculateField_management(wMainPrimaGRD__41_, "RIESGO_PRY", "RIESGO", "VB", "Dim RIESGO \\n\\nIf [PELIGRO_MTP] = 0 then\\nRIESGO = 0\\n\\nelseif [PELIGRO_MTP] >=1 then\\nRIESGO = (( [PELIGRO_MTP] *[Wp])+( [VULNERA_PRY] * [WV_PRY]))/( [Wp]+ [WV_PRY] )\\n\\nelse\\nRIESGO = 6\\n\\nend if")

# Process: Add Field (2)
arcpy.AddField_management(wMainPrimaGRD__42_, "GRADO_PELIGRO", "TEXT", "", "", "50", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (13)
arcpy.AddField_management(wMainPrimaGRD__43_, "GRADO_VULNERA", "TEXT", "", "", "20", "Grado_Vulnerabilidad", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (14)
arcpy.AddField_management(wMainPrimaGRD__44_, "GRADO_RIESGO", "TEXT", "", "", "30", "Grado_Riesgo", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field (2)
arcpy.CalculateField_management(wMainPrimaGRD__45_, "GRADO_PELIGRO", "PELIGROS ", "VB", "Dim PELIGROS \\n\\nIf [PELIGRO_MTP] =0 then\\nPELIGROS = \"Muy Alto, No Mitigable\"\\n\\nelseif [PELIGRO_MTP] =1 then\\nPELIGROS = \"Muy Alto\"\\n\\nelseif [PELIGRO_MTP] =2 then\\nPELIGROS = \"Alto\"\\n\\nelseif [PELIGRO_MTP] =3 then\\nPELIGROS = \"Medio\"\\n\\nelseif [PELIGRO_MTP] =4 then\\nPELIGROS = \"Bajo\"\\n\\nelseif [PELIGRO_MTP] =5 then\\nPELIGROS = \"Muy Bajo\"\\n\\nelse\\nPELIGROS = \"Falto Dato\"\\nend if")

# Process: Calculate Field (12)
arcpy.CalculateField_management(wMainPrimaGRD__46_, "GRADO_VULNERA", "GRADO_VULNE", "VB", "Dim GRADO_VULNE\\n\\nIf [PELIGRO_MTP] = 0 then\\nGRADO_VULNE = \"Muy Alta, No Mitigable\"\\n\\nelseif [VULNERABI] >0 AND [VULNERABI] <=1 then\\nGRADO_VULNE = \"Muy Alta\"\\n\\nelseif [VULNERABI] >1 AND [VULNERABI] <=2 then\\nGRADO_VULNE = \"Alta\"\\n\\nelseif [VULNERABI] >2 AND [VULNERABI] <=3 then\\nGRADO_VULNE = \"Media\"\\n\\nelseif [VULNERABI] >3 AND [VULNERABI] <=4 then\\nGRADO_VULNE = \"Baja\"\\n\\nelseif [VULNERABI] >4 AND [VULNERABI] <=5 then\\nGRADO_VULNE = \"Muy Baja\"\\n\\nelse\\nGRADO_VULNE = \"Falto Dato\"\\n\\nend if")

# Process: Calculate Field (13)
arcpy.CalculateField_management(wMainPrimaGRD__47_, "GRADO_RIESGO", "GRADO_RIES", "VB", "Dim GRADO_RIES   \\n\\nIf [PELIGRO_MTP] = 0 then\\nGRADO_RIES = \"Muy Alto, No Mitigable\"\\n\\nelseif [RIESGO] >0 AND [RIESGO] <=1 then\\nGRADO_RIES = \"Muy Alto\"\\n\\nelseif [RIESGO] >1 AND [RIESGO] <=2 then\\nGRADO_RIES = \"Alto\"\\n\\nelseif [RIESGO] >2 AND [RIESGO] <=3 then\\nGRADO_RIES = \"Medio\"\\n\\nelseif [RIESGO] >3 AND [RIESGO] <=4 then\\nGRADO_RIES = \"Bajo\"\\n\\nelseif [RIESGO] >4 AND [RIESGO] <=5 then\\nGRADO_RIES = \"Muy Bajo\"\\n\\nelse\\nGRADO_RIES = \"Falto Dato\"\\n\\nend if")

# Process: Add Field (24)
arcpy.AddField_management(wMainPrimaGRD__48_, "GRADO_VULNEPRY", "TEXT", "", "", "30", "Grado_VulnerPRY", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (25)
arcpy.AddField_management(wMainPrimaGRD__49_, "GRADO_RIESGOPRY", "TEXT", "", "", "30", "Grado_Riesgo_Proyectado", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field (25)
arcpy.CalculateField_management(wMainPrimaGRD__50_, "GRADO_VULNEPRY", "VULNERABILIDAD", "VB", "Dim VULNERABILIDAD \\n\\nIf [PELIGRO_MTP] =0 then\\nVULNERABILIDAD = \"Muy Alta, No Mitigable\"\\n\\nelseif [VULNERA_PRY] >0 AND [VULNERA_PRY] <=1 then\\nVULNERABILIDAD = \"Muy Alta\"\\n\\nelseif [VULNERA_PRY] >1 AND [VULNERA_PRY] <=2 then\\nVULNERABILIDAD = \"Alta\"\\n\\nelseif [VULNERA_PRY] >2 AND [VULNERA_PRY] <=3 then\\nVULNERABILIDAD = \"Media\"\\n\\nelseif [VULNERA_PRY] >3 AND [VULNERA_PRY] <=4 then\\nVULNERABILIDAD = \"Baja\"\\n\\nelseif [VULNERA_PRY] >4 AND [VULNERA_PRY] <=5 then\\nVULNERABILIDAD = \"Muy Baja\"\\n\\nelse\\nVULNERABILIDAD = \"Falto Dato\"\\n\\nend if")

# Process: Calculate Field (26)
arcpy.CalculateField_management(wMainPrimaGRD__51_, "GRADO_RIESGOPRY", "GRADO_RIES", "VB", "Dim GRADO_RIES \\n\\nIf [PELIGRO_MTP] = 0 then\\nGRADO_RIES = \"Muy Alto, No Mitigable\"\\n\\nelseif [RIESGO_PRY] >0 AND [RIESGO_PRY] <=1 then\\nGRADO_RIES = \"Muy Alto\"\\n\\nelseif [RIESGO_PRY] >1 AND [RIESGO_PRY] <=2 then\\nGRADO_RIES = \"Alto\"\\n\\nelseif [RIESGO_PRY] >2 AND [RIESGO_PRY] <=3 then\\nGRADO_RIES = \"Medio\"\\n\\nelseif [RIESGO_PRY] >3 AND [RIESGO_PRY] <=4 then\\nGRADO_RIES = \"Bajo\"\\n\\nelseif [RIESGO_PRY] >4 AND [RIESGO_PRY] <=5 then\\nGRADO_RIES = \"Muy Bajo\"\\n\\nelse\\nGRADO_RIES = \"Falto Dato\"\\n\\nend if")

